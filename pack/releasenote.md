# process_guard_20250922

## ğŸ†• v2.0.0 æ›´æ–°å†…å®¹ (2025-09-22)

### æ–°å¢åŠŸèƒ½
- **æ”¯æŒå¤šå®ä¾‹ç›‘æ§**ï¼šç°åœ¨å¯ä»¥ç›‘æ§å¤šä¸ªåŒåè¿›ç¨‹ï¼ˆå¦‚å¤šä¸ª dwm.exeï¼‰ï¼Œä»»æ„ä¸€ä¸ªè¿›ç¨‹è¶…å‡ºå†…å­˜é™åˆ¶éƒ½ä¼šè§¦å‘é‡å¯æ“ä½œ
- **æ–°å¢é‡å¯å†·å´æœºåˆ¶**ï¼šæ·»åŠ  `cooldown_seconds` é…ç½®é¡¹ï¼ˆé»˜è®¤60ç§’ï¼‰ï¼Œé˜²æ­¢é¢‘ç¹é‡å¯åŒä¸€è¿›ç¨‹
- **çµæ´»çš„é‡å¯ç­–ç•¥**ï¼šæ–°å¢ `restart_all_on_threshold` é…ç½®é¡¹ï¼Œå¯é€‰æ‹©é‡å¯æ‰€æœ‰åŒåè¿›ç¨‹æˆ–ä»…é‡å¯è¶…é™çš„è¿›ç¨‹
- **æ”¹è¿›çš„æ—¥å¿—è¾“å‡º**ï¼šæ¸…æ™°æ˜¾ç¤ºæ¯ä¸ªè¿›ç¨‹çš„ PID å’Œå†…å­˜ä½¿ç”¨æƒ…å†µï¼ŒåŒ…å«é‡å¯ç›®æ ‡å’Œå‰©ä½™å†·å´æ—¶é—´
- **æŒ‰PIDç²¾ç¡®é‡å¯**ï¼šæ”¯æŒæŒ‰è¿›ç¨‹IDç²¾ç¡®é‡å¯ç‰¹å®šè¿›ç¨‹ï¼Œè€Œä¸æ˜¯ä»…æŒ‰è¿›ç¨‹å

### é…ç½®æ–‡ä»¶æ›´æ–°
- **æ–°å¢é…ç½®é¡¹ `restart_all_on_threshold`**ï¼šfalse = ä»…é‡å¯è¶…é™è¿›ç¨‹ï¼Œtrue = é‡å¯æ‰€æœ‰åŒåè¿›ç¨‹
- **æ–°å¢é…ç½®é¡¹ `cooldown_seconds`**ï¼šé‡å¯å†·å´æ—¶é—´ï¼Œé˜²æ­¢é¢‘ç¹é‡å¯ï¼ˆé»˜è®¤60ç§’ï¼‰
- **æ ¼å¼ä¼˜åŒ–**ï¼šä¿®æ­£JSONæ ¼å¼ï¼Œç¡®ä¿é…ç½®æ–‡ä»¶æ ‡å‡†åŒ–

### æŠ€æœ¯æ”¹è¿›
- æ–°å¢ `find_processes_by_name` å‡½æ•°ï¼Œæ”¯æŒè¿”å›æ‰€æœ‰åŒ¹é…åç§°çš„è¿›ç¨‹åˆ—è¡¨
- é‡æ„ `monitor_process` å‡½æ•°ï¼Œéå†æ£€æŸ¥æ¯ä¸ªåŒåè¿›ç¨‹çš„å†…å­˜ä½¿ç”¨æƒ…å†µ
- æ·»åŠ  `kill_processes_by_pid` æ–¹æ³•ï¼Œæ”¯æŒæŒ‰PIDåˆ—è¡¨ç²¾ç¡®ç»ˆæ­¢è¿›ç¨‹
- æ–°å¢é‡å¯æ—¶é—´è·Ÿè¸ªæœºåˆ¶ï¼Œä½¿ç”¨ `LAST_RESTART_TIMES` å…¨å±€çŠ¶æ€ç®¡ç†
- ä¿æŒå‘ä¸‹å…¼å®¹æ€§ï¼ŒåŸæœ‰é…ç½®æ–‡ä»¶æ— éœ€ä¿®æ”¹

---

# process_guard_20241127

### åŠŸèƒ½

- æ‰“å°ç³»ç»Ÿä¿¡æ¯ï¼ˆæ“ä½œç³»ç»Ÿç‰ˆæœ¬ã€æ˜¾ç¤ºé©±åŠ¨ç¨‹åºç‰ˆæœ¬ã€å†…å­˜ä¿¡æ¯ç­‰ï¼‰
- ç›‘æ§è¿›ç¨‹å†…å­˜ä½¿ç”¨æƒ…å†µå¹¶åœ¨è¶…è¿‡é˜ˆå€¼æ—¶é‡å¯è¿›ç¨‹
- å°†è¿›ç¨‹ä¿¡æ¯æ’å…¥æ•°æ®åº“å¹¶å®šæœŸæ¸…ç†æ—§æ•°æ®

### ä½¿ç”¨

1. å®‰è£…åæ— éœ€æ“ä½œï¼ŒæœåŠ¡ä¼šè‡ªåŠ¨è¿è¡Œã€‚
2. å¦‚æœéœ€è¦æ‰‹åŠ¨å¯åŠ¨æˆ–åœæ­¢æœåŠ¡ï¼Œå¯ä»¥è¿è¡Œ `start_service.bat` å’Œ `stop_service.bat`ã€‚

### é…ç½®

> å®‰è£…æˆåŠŸåï¼Œä¼šåœ¨å®‰è£…ç›®å½•ä¸‹è‡ªåŠ¨ç”Ÿæˆ `config.json` æ–‡ä»¶ï¼Œå¯ä»¥åœ¨æ­¤æ–‡ä»¶ä¸­ä¿®æ”¹é…ç½®ã€‚

```json
{
  "processes": [
    {
      "name": "dwm.exe",
      "memory_threshold_bytes": 1048576000,
      "process_type": "System",
      "auto_start": false
    },
    {
      "name": "Microsoft.photos.exe",
      "memory_threshold_bytes": 2048576000,
      "process_type": "System",
      "auto_start": false
    }
  ],
  "interval_seconds": 60,
  "db_config": {
    "insert_into_db": true,
    "db_cleanup_hours": 720,
    "db_vacuum_threshold_mb": 500,
    "cleanup_interval_hours": 12
  }
}
```

- `processes`: ç›‘æ§çš„è¿›ç¨‹åˆ—è¡¨ã€‚
  - `name`: è¿›ç¨‹åç§°ã€‚
  - `memory_threshold_bytes`: å†…å­˜é˜ˆå€¼ï¼Œå•ä½ä¸ºå­—èŠ‚ã€‚
  - `process_type`: è¿›ç¨‹ç±»å‹ï¼Œå¯ä»¥æ˜¯ `System`, `Service(String)` æˆ– `User(String, u32)`ã€‚
  - `auto_start`: æ˜¯å¦è‡ªåŠ¨å¯åŠ¨è¿›ç¨‹ã€‚
- `interval_seconds`: ç›‘æ§é—´éš”æ—¶é—´ï¼Œå•ä½ä¸ºç§’ã€‚
- `db_config`: æ•°æ®åº“é…ç½®ã€‚
  - `insert_into_db`: æ˜¯å¦å°†è¿›ç¨‹ä¿¡æ¯æ’å…¥æ•°æ®åº“ã€‚
  - `db_cleanup_hours`: æ•°æ®åº“æ¸…ç†æ—¶é—´é—´éš”ï¼Œå•ä½ä¸ºå°æ—¶ã€‚
  - `db_vacuum_threshold_mb`: æ•°æ®åº“çœŸç©ºæ“ä½œçš„é˜ˆå€¼ï¼Œå•ä½ä¸ºMBã€‚
  - `cleanup_interval_hours`: æ•°æ®åº“æ¸…ç†æ“ä½œçš„æ—¶é—´é—´éš”ï¼Œå•ä½ä¸ºå°æ—¶ã€‚